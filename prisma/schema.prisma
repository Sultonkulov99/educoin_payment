generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum PaymentStatus {
  PENDING
  SUCCESS
  FAILED
  CANCELLED
}

enum PaidVia {
  PAYME
  CLICK
  CASH
}

model Center {
  id           Int           @id @default(autoincrement())
  name         String
  payments     Payment[]
  transactions Transaction[]

  @@map("centers")
}

model Payment {
  id            Int           @id @default(autoincrement())
  amount        Decimal       @db.Decimal(12, 2)
  status        PaymentStatus @default(PENDING)
  transactionId String?       @unique
  transaction   Transaction?  @relation(fields: [transactionId], references: [id])
  // startDate     DateTime
  // endDate       DateTime
  paidVia       PaidVia
  centerId     Int?
  center        Center?        @relation(fields: [centerId], references: [id])
  paidAt        DateTime      @default(now())

  @@map("payments")
}

model Transaction {
  id           String    @id @default(uuid())
  pid          String    @unique
  amount       Decimal   @db.Decimal(12, 2)
  perform_time DateTime?
  create_time  DateTime?
  cancel_time  DateTime?
  state        Int
  reason       Int?
  centerId     Int?
  center       Center?   @relation(fields: [centerId], references: [id], onDelete: SetNull)

  payment Payment[]

  @@map("transactions")
}
